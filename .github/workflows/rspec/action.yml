name: Rspec Tests

runs:
  using: composite
  services:
    postgres:
      image: postgres:11-alpine
      ports:
        - "5432:5432"
      env:
        POSTGRES_DB: rails_test
        POSTGRES_USER: rails
        POSTGRES_PASSWORD: password
  env:
    RAILS_ENV: test
    DATABASE_URL: "postgres://rails:password@localhost:5432/rails_test"
  steps:
    - uses: actions/checkout@v4
    # dependencies
    - uses: ruby/setup-ruby@55283cc23133118229fd3f97f9336ee23a179fcf # v1.146.0
      with:
        bundler-cache: true
    # database setup
    - name: Set up database schema
      shell: sh
      run: bin/rails db:schema:load
    # test runners
    - name: Run tests
      shell: sh
      run: bin/rspec