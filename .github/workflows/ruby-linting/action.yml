name: Ruby Linting

runs:
  using: composite
  steps:
    - uses: actions/checkout@v4
    - uses: ruby/setup-ruby@cacc9f1c0b3f4eb8a16a6bb0ed10897b43b9de49 # v1.176.0
      with:
        bundler-cache: true
    - name: Security audit dependencies
      shell: sh
      run: gem install bundler-audit; bundle-audit check --update
    - name: Security audit application code
      shell: sh
      run: gem install brakeman; brakeman -q -w2
    - name: Lint Ruby files
      shell: sh
      run: bundle exec rubocop --parallel